# RoutAI

## Usage

To run this application create a .env file and enter the required API keys.

```bash
cp .env.example .env
```

Then ensure Docker is running and simply run:

```bash
docker compose up
```

## Overview

### Agentic Workflow

I used LangGraph to build the backend AI system. My main requirements were:

 - Route Optimisation: Once a route has been create the system should be able to update it based on user requests.
 - Real Data Fetching: Ensure that route information is provide by tools rather than generated by the AI.

To tackle this I created a graph of 4 steps.

#### Planning

The first stage is to take a user query and turn it into a set of RouteRequirements which is explicitly defined using Pydantic. If the user doesnt provide enough information it wil ask the user to provide the details it needs e.g average daily distance to cycle

#### Route Creation

Within the graph route creation and inital accommodation fetching is a deterministic process. The RouteRequirements act as the input and the final result is the Route and Segments being added to the state. These contain coordinates, names, routes, accommodation options for each day of the trip.

#### Optimisation

This is another agentic stage that allows alterations to the route. The optimiser agent has acces to tools that let it update the Route and Segments in the state so it can do things like recalculate the segments for a different daily distance.

#### Review

The review step is another agentic step that presents the user with a trip summary base on the current stat information. It also has access to tool, such as get_weather, so it can add additional info to the overview.

### Tech Choices

 - **LangGraph:** I opted for LangGraph over Langchain so I could build the multi stage approach with a global state. The global state is accessible at any time and identifed using a thread_id, this allows accesing route data without interacting with the Workflow.

 - **Pydantic** Perfct for type validation and a number of AI models support structured output defined by Pydantic.

### Repositry Architecture

backend/
├── app/
│   ├── main.py                  # Application entry point
│   │
│   ├── api/                     # FastAPI application layer
│   │   ├── deps.py              # Dependency injection
│   │   ├── routes/              # API endpoints
│   │   │   ├── chats.py         # Chat streaming endpoints
│   │   │   └── sessions.py      # Session management endpoints
│   │   │   
│   │   └── services/            
│   │       ├── session_manager.py  # Session state management
│   │       └── streaming.py        # SSE streaming logic
│   │
│   ├── agent/                   # LangGraph agent implementation
│   │   ├── config/               
│   │   │   ├── llm.py           # Claude LLM setup
│   │   │   └── prompts.py       # System prompts for each agent
│   │   │ 
│   │   ├── graph/               
│   │   │   ├── routing.py       # Conditional routing logic
│   │   │   └── workflow.py      # Main LangGraph workflow definition
│   │   │
│   │   └── nodes/                
│   │       ├── logistics.py     # Accommodation search node
│   │       ├── optimiser.py     # Route optimization node
│   │       ├── planner.py       # Requirements gathering node
│   │       ├── reviewer.py      # Route review and confirmation node
│   │       ├── router.py        # Route calculation node
│   │       └── writer.py        # Itinerary generation node
│   │ 
│   ├── models/                  # Pydantic data models
│   │   ├── api.py               # API request/response models
│   │   ├── models.py            # Core domain models
│   │   └── state.py             # Agent state models
│   │
│   ├── tools/                   # LangChain tools for agents
│   │   ├── accommodation.py     # Accommodation search tools
│   │   ├── location.py          # Geocoding tools
│   │   ├── route.py             # Route manipulation tools
│   │   ├── segment.py           # Segment inspection tools
│   │   ├── utils.py             # Tool utilities
│   │   └── weather.py           # Weather information tools
│   │
│   ├── utils/                   # Shared utilities
│   │   └── utils.py             # Google API integrations, calculations
│   │
│   ├── config/                  # Application configuration
│   │   ├── config.py            # Settings and environment variables
│   │   └── logging.py           # Logging configuration
│   │
├── scripts/                     # Development and utility scripts
├── tests/                       # Test suite
└── pyproject.toml               # Project dependencies (uv)
 